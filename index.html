<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Solar & AQI Command Center - Mumbai</title>

<style>
:root{
--bg:#0f172a;
--accent:#f59e0b;
--accent-light:#fde68a;
--accent-dark:#b45309;
--card:#ffffff;
--text:#1e293b;
--green:#16a34a;
--orange:#d97706;
--red:#dc2626;
}

*{margin:0;padding:0;box-sizing:border-box;}

body{
font-family:'Inter',system-ui,sans-serif;
background:
radial-gradient(circle at top, rgba(245,158,11,0.25), transparent 60%),
linear-gradient(135deg,var(--bg),#1e293b);
color:var(--text);
min-height:100vh;
}

.container{max-width:1400px;margin:0 auto;padding:20px;}

.header{text-align:center;color:white;padding:40px 0;}

.mantra{
font-size:1.1rem;
color:#fbbf24;
letter-spacing:4px;
margin-bottom:10px;
text-shadow:0 0 12px rgba(251,191,36,0.6);
font-weight:700;
}

.header h1{
font-size:2.8rem;
letter-spacing:3px;
background:linear-gradient(45deg,white,var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

.header .city{
color:var(--accent);
font-weight:900;
font-size:1.6rem;
margin-top:10px;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
gap:25px;
margin-bottom:30px;
}

.card{
background:var(--card);
border-radius:24px;
padding:30px;
text-align:center;
box-shadow:0 20px 40px rgba(0,0,0,0.3);
transition:all .3s ease;
border:1px solid #e2e8f0;
}

.card:hover{
transform:translateY(-5px);
box-shadow:0 0 25px rgba(245,158,11,0.35);
}

.highlight-card{
background:linear-gradient(135deg,#fff7ed,#ffedd5);
}

.stat{
font-size:3.2rem;
font-weight:900;
margin:15px 0;
color:var(--bg);
}

.stat-large{font-size:4rem!important;}

.label{
color:#64748b;
text-transform:uppercase;
font-size:.9rem;
font-weight:800;
letter-spacing:1.5px;
}

/* temperature colors */
.temp-cold{color:#3b82f6;}
.temp-warm{color:#f59e0b;}
.temp-hot{color:#dc2626;}

.times-grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
gap:20px;
margin:20px 0;
}

.time-item{
background:linear-gradient(135deg,#f8fafc,#e2e8f0);
padding:20px;
border-radius:16px;
font-weight:700;
border-left:5px solid var(--accent);
}

.time-item .date{font-size:.85rem;color:#64748b;margin-bottom:8px;font-weight:600;}
.time-item .time{font-size:1.8rem;color:var(--bg);margin-bottom:5px;}
.time-item .duration{font-size:1rem;color:var(--accent);font-weight:700;}

.aqi-status{
font-weight:bold;
font-size:1.1rem;
margin-top:10px;
padding:8px 16px;
border-radius:25px;
display:inline-block;
box-shadow:0 4px 12px rgba(0,0,0,.1);
}

.status-safe{background:rgba(22,163,74,.15);color:var(--green);}
.status-moderate{background:rgba(217,119,6,.15);color:var(--orange);}
.status-unhealthy{background:rgba(220,38,38,.15);color:var(--red);}

.table-container{
background:white;
border-radius:24px;
box-shadow:0 20px 40px rgba(0,0,0,.3);
overflow:hidden;
margin-bottom:20px;
border:1px solid #e2e8f0;
}

.table-title{
padding:25px 30px;
background:linear-gradient(135deg,#f8fafc,#e2e8f0);
font-size:1.3rem;
font-weight:700;
color:#1e293b;
border-bottom:1px solid #e2e8f0;
}

table{width:100%;border-collapse:collapse;font-size:.95rem;}

th{
background:var(--accent);
color:white;
padding:18px 15px;
text-align:left;
font-weight:700;
text-transform:uppercase;
letter-spacing:.5px;
font-size:.85rem;
position:sticky;
top:0;
}

td{padding:15px;border-bottom:1px solid #f1f5f9;}
tr:nth-child(even){background:#f9fafb;}
tr:hover{background:#f8fafc;}

.date-col{font-weight:600;min-width:120px;}
.time-col{min-width:100px;}
.duration-col{min-width:100px;color:var(--accent);font-weight:600;}

#loader{
position:fixed;
inset:0;
background:var(--bg);
color:white;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
z-index:10000;
font-size:1.3rem;
}

.spin{animation:spin 4s linear infinite;}
@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}

.btn{
background:linear-gradient(45deg,var(--accent),var(--accent-dark));
color:white;border:none;padding:16px 32px;border-radius:12px;
cursor:pointer;font-weight:700;margin-top:25px;font-size:1.1rem;
transition:.3s;
}
.btn:hover{transform:scale(1.05);}

/* digital timer */
#cd{
font-family:monospace;
background:#020617;
color:#fbbf24;
padding:10px 20px;
border-radius:10px;
display:inline-block;
letter-spacing:3px;
}

@media(max-width:768px){
.grid{grid-template-columns:1fr;}
.times-grid{grid-template-columns:1fr;}
.stat{font-size:2.5rem!important;}
table{font-size:.85rem;}
th,td{padding:12px 8px;}
}
</style>
</head>

<body>

<div id="loader">
<div id="loader-text" class="spin">üåÖ Loading Solar & Air Data...</div>
<button id="force-btn" class="btn" style="display:none;" onclick="useOfflineData()">Use Mumbai Data</button>
</div>

<div class="container" style="display:none;" id="main-content">

<div class="header">
<div class="mantra">‡•ê ‡§∏‡•Ç‡§∞‡•ç‡§Ø ‡§¶‡•á‡§µ‡§æ‡§Ø ‡§®‡§Æ‡§É</div>
<h1>üåÖ Solar Command Center</h1>
<div class="city">Mumbai, Maharashtra | <span id="current-date"></span></div>
</div>

<div class="grid">
<div class="card">
<div class="label">üå°Ô∏è Current Temperature</div>
<div class="stat" id="temp">--¬∞C</div>
<div class="label" id="temp-label">Loading...</div>
</div>

<div class="card">
<div class="label">üå´Ô∏è Air Quality (PM2.5)</div>
<div class="stat" id="aqi">--</div>
<div id="aqi-msg" class="aqi-status">Loading...</div>
</div>

<div class="card highlight-card">
<div class="label">‚è≥ Next Solar Event</div>
<div class="stat" id="cd">00:00:00</div>
<div class="label" id="cd-label">Loading...</div>
</div>

<div class="card">
<div class="label">‚òÄÔ∏è Today's Sun Duration</div>
<div class="stat stat-large" id="daylight">--h --m</div>
<div class="label" id="today-label"></div>
</div>
</div>

<div class="times-grid">
<div class="card time-item" style="grid-column: span 2;">
<div class="label" style="text-align:center;margin-bottom:20px;">Key Solar Times</div>
<div class="times-grid" id="times-list"></div>
</div>
</div>

<div class="table-container">
<div class="table-title">üìä 30-Day Solar Data Points (Sunrise ‚Üí Sunset ‚Üí Duration)</div>
<div style="overflow-x:auto;">
<table id="solar-table">
<thead>
<tr>
<th>Date</th>
<th>Sunrise</th>
<th>Sunset</th>
<th>Sun Duration</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>

</div>

<script>
const LOC={lat:19.0760,lon:72.8777};
let currentData={};
let todaySunrise,todaySunset;

async function init(){

document.getElementById('current-date').textContent=
new Date().toLocaleDateString('en-IN',{weekday:'long',year:'numeric',month:'long',day:'numeric'});

document.getElementById('today-label').textContent=
"Today ‚Ä¢ "+new Date().toLocaleDateString('en-IN',{day:'numeric',month:'short'});

try{
document.getElementById('loader-text').innerText='üå§Ô∏è Fetching Weather Data...';

const promises=[fetchSunData(),fetchWeatherData(),fetchAQI()];
const [sun,weather,aqi]=await Promise.allSettled(promises);

if(sun.status==='fulfilled'){
currentData.sun=sun.value;
updateSunTimes(sun.value);
updateSolarTable(sun.value);
}

if(weather.status==='fulfilled'){
currentData.weather=weather.value;
updateWeather(weather.value);
}

if(aqi.status==='fulfilled'){
currentData.aqi=aqi.value;
updateAQI(aqi.value);
}

renderAll();
document.getElementById('loader').style.display='none';
document.getElementById('main-content').style.display='block';

}catch(e){
document.getElementById('loader-text').innerText="üåê API Access Limited";
document.getElementById('force-btn').style.display='block';
}
}

async function fetchSunData(){
try{
const res=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${LOC.lat}&longitude=${LOC.lon}&daily=sunrise,sunset&timezone=Asia%2FKolkata&forecast_days=30`);
if(!res.ok)throw new Error();
const data=await res.json();
return data.daily;
}catch(e){return generateMumbaiData();}
}

async function fetchWeatherData(){
try{
const res=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${LOC.lat}&longitude=${LOC.lon}&current=temperature_2m&timezone=Asia%2FKolkata`);
if(!res.ok)throw new Error();
return await res.json();
}catch(e){return{current:{temperature_2m:29}};}
}

async function fetchAQI(){
try{
const res=await fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${LOC.lat}&longitude=${LOC.lon}&current=pm2_5&timezone=Asia%2FKolkata`);
if(!res.ok)throw new Error();
return await res.json();
}catch(e){return{current:{pm2_5:24}};}
}

function generateMumbaiData(){
return{
sunrise:["2026-02-22T07:05:00"],
sunset:["2026-02-22T18:42:00"]
};
}

function updateSunTimes(sunData){
todaySunrise=new Date(sunData.sunrise[0]);
todaySunset=new Date(sunData.sunset[0]);
updateTodayDuration();
}

function updateSolarTable(){}

function getDuration(start,end){
const diff=end-start;
const hours=Math.floor(diff/(1000*60*60));
const minutes=Math.floor((diff%(1000*60*60))/(1000*60));
return `${hours}h ${minutes.toString().padStart(2,'0')}m`;
}

function updateTodayDuration(){
if(todaySunrise&&todaySunset){
document.getElementById('daylight').textContent=getDuration(todaySunrise,todaySunset);
}
}

function updateWeather(weather){
const temp=Math.round(weather.current.temperature_2m||29);
const el=document.getElementById('temp');
el.textContent=temp+'¬∞C';
el.className='stat '+(temp<25?'temp-cold':temp<30?'temp-warm':'temp-hot');

document.getElementById('temp-label').textContent=
temp>32?'VERY HOT ‚òÄÔ∏è':temp>28?'HOT ‚òÄÔ∏è':temp>24?'WARM üå§Ô∏è':'COMFORTABLE üå•Ô∏è';
}

function updateAQI(aqi){
const pm25=Math.round((aqi.current.pm2_5||24)*10)/10;
document.getElementById('aqi').textContent=pm25;
const msg=document.getElementById('aqi-msg');

if(pm25<=12){msg.textContent='‚óè SAFE';msg.className='aqi-status status-safe';}
else if(pm25<=35){msg.textContent='‚óè MODERATE';msg.className='aqi-status status-moderate';}
else{msg.textContent='‚óè UNHEALTHY';msg.className='aqi-status status-unhealthy';}
}

function renderAll(){if(todaySunrise&&todaySunset)startCountdown();}

function startCountdown(){
setInterval(()=>{
const now=new Date();
let target,label;

if(now<todaySunrise){target=todaySunrise;label='Sunrise üåÖ';}
else if(now<todaySunset){target=todaySunset;label='Sunset üåá';}
else{target=new Date(todaySunrise);target.setDate(target.getDate()+1);label="Tomorrow's Sunrise üåÖ";}

let diff=target-now;if(diff<0)diff=0;
const h=Math.floor(diff/3600000).toString().padStart(2,"0");
const m=Math.floor((diff%3600000)/60000).toString().padStart(2,"0");
const s=Math.floor((diff%60000)/1000).toString().padStart(2,"0");

document.getElementById('cd').textContent=`${h}:${m}:${s}`;
document.getElementById('cd-label').textContent=label;
},1000);
}

init();
</script>

</body>
</html>
